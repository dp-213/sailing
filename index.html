<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dalmatien Segeltörn – Sommer & Dolce Vita</title>
  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
    integrity="sha256-sA+Rl4xQJazwXBttGUI4G/3XZB1yeSPrB4pW4jftd04="
    crossorigin=""
  />
  <!-- Google Maps custom styles -->
  <link rel="stylesheet" href="css/gmaps.css" />
  <style>
    /* Top spots controls */
    .map-controls{position:fixed;right:12px;top:88px;background:#ffffffd9;border:1px solid #e5e7eb;border-radius:.5rem;padding:.5rem .6rem;backdrop-filter:saturate(180%) blur(6px);box-shadow:0 2px 8px rgba(0,0,0,.08);font-size:.85rem;z-index:1000}
    .map-controls h4{margin:.2rem 0 .4rem;font-size:.9rem}
    .map-controls .row{display:flex;gap:.35rem;flex-wrap:wrap;margin-bottom:.35rem}
    .chip{display:inline-block;padding:.15rem .45rem;border-radius:.5rem;border:1px solid #e5e7eb;cursor:pointer;user-select:none}
    .chip.active{background:#eef2ff;border-color:#c7d2fe}
    .map-controls a{color:#0ea5e9;text-decoration:none}
    body {
      font-family: 'Montserrat', sans-serif;
      margin: 0;
      line-height: 1.6;
      color: #333;
      background-color: #fafafa;
    }
    header {
      background-color: #0077b6;
      color: white;
      text-align: center;‚
      padding: 2rem 1rem;
    }
    header h1 {
      margin: 0;
      font-size: 2rem;
    }
    header p {
      margin-top: 0.5rem;
      font-size: 1rem;
    }
    nav {
      display: flex;
      overflow-x: auto;
      background: #ffffff;
      border-bottom: 1px solid #eee;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    nav a {
      flex: 0 0 auto;
      padding: 0.75rem 1rem;
      color: #0077b6;
      text-decoration: none;
      font-weight: 600;
      white-space: nowrap;
      border-right: 1px solid #f0f0f0;
    }
    nav a:last-child {
      border-right: none;
    }
    nav a:hover {
      background: #f5f7f9;
    }
    .container {
      max-width: 960px;
      margin: auto;
      padding: 1rem;
    }
    /* Remove old Leaflet map style (map div removed) */
    #map {
      display: none;
    }

    /* Adjust Google map height for top placement */
    .gmaps-map {
      height: 320px;
    }
    section {
      margin-bottom: 2rem;
    }
    section h2 {
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
      color: #023e8a;
    }
    .day-content ul {
      list-style-type: disc;
      padding-left: 1.2rem;
      margin-top: 0.5rem;
    }
    .day-content li {
      margin-bottom: 0.4rem;
    }
    .info {
      background: #e8f4fd;
      border-left: 4px solid #0077b6;
      padding: 0.8rem;
      margin-top: 1rem;
      border-radius: 4px;
      font-size: 0.9rem;
    }
    .info strong {
      display: block;
      margin-bottom: 0.4rem;
      font-size: 1rem;
      color: #023e8a;
    }
    /* Responsive tweaks */
    @media (max-width: 600px) {
      header h1 {
        font-size: 1.5rem;
      }
      nav a {
        padding: 0.5rem 0.8rem;
        font-size: 0.9rem;
      }
    }

    /* Allergy card styles */
    .allergy-btn {
      display: inline-block;
      margin: 1rem 0;
      padding: 0.6rem 1rem;
      background-color: #0077b6;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
    }
    .allergy-btn:hover, .allergy-btn:focus {
      background-color: #005f8e;
    }
    .allergy-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      align-items: center;
      justify-content: center;
      padding: 1rem;
      z-index: 1000;
    }
    .allergy-modal[aria-hidden="false"] {
      display: flex;
    }
    .allergy-modal-content {
      background: white;
      padding: 1.5rem;
      border-radius: 8px;
      max-width: 400px;
      width: 100%;
      text-align: center;
    }
    .allergy-close {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      background: #0077b6;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .allergy-close:hover, .allergy-close:focus {
      background: #005f8e;
    }

    /* Allergy language tabs */
    .allergy-tabs {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }
    .lang-btn {
      padding: 0.4rem 0.6rem;
      background: #fff;
      border: 1px solid #0077b6;
      color: #0077b6;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.8rem;
    }
    .lang-btn.active {
      background: #0077b6;
      color: #fff;
    }
  </style>
</head>
<body>
  <header>
    <h1>7 Tage Summer Sailing &amp; Dolce Vita</h1>
    <p>Dalmatien per Segelyacht – Genuss &amp; Abenteuer zwischen Split, Šolta, Pakleni&nbsp;Inseln, Hvar &amp; Brač</p>
    <p class="intro-message">Erlebe sieben Tage zwischen türkisfarbenem Meer, pittoresken Inseln und mediterranem Dolce&nbsp;Vita – diese Mini‑Broschüre zeigt euch die perfekte Mischung aus Segeln, Genuss und Kultur.</p>
  </header>
  <nav id="itinerary-nav">
    <a href="topspots.html">Top Spots</a>
    <a href="#day1">Tag 1</a>
    <a href="#day2">Tag 2</a>
    <a href="#day3">Tag 3</a>
    <a href="#day4">Tag 4</a>
    <a href="#day5">Tag 5</a>
    <a href="#day6">Tag 6</a>
    <a href="#day7">Tag 7</a>
  </nav>
  <div class="container">
    <!-- Google Maps interactive route at top -->
    <section id="route" aria-labelledby="route-heading">
      <h2 id="route-heading">Interaktive Route</h2>
      <div class="gmaps-layout">
        <div id="gmaps-map" class="gmaps-map" role="application" aria-label="Karte mit Segelroute"></div>
        <aside class="gmaps-sidebar" aria-label="Liste der Stopps">
          <div class="gmaps-controls">
            <label for="mode" class="sr-only">Fortbewegungsart</label>
            <select id="mode" aria-label="Reisemodus">
              <option value="DRIVING" selected>Boot/Driving</option>
              <option value="WALKING">Walking</option>
              <option value="BICYCLING">Bicycling</option>
              <option value="TRANSIT">Transit</option>
            </select>
            <button id="btn-recalc" type="button" aria-label="Route neu berechnen">Neu berechnen</button>
            <button id="btn-geoloc" type="button" aria-label="Meine Position als Start verwenden">Meine Position</button>
            <a id="export-link" target="_blank" rel="noopener" aria-label="Route in Google Maps öffnen">In Google Maps öffnen</a>
          </div>
          <ul id="stops-list" class="gmaps-list" role="listbox" aria-label="Stopps"></ul>
          <div id="gmaps-error" class="gmaps-error" role="alert" aria-live="assertive" hidden></div>
        </aside>
      </div>
    </section>
    <!-- Allergy card modal (triggered from info section) -->
    <div id="allergy-modal" class="allergy-modal" aria-hidden="true">
      <div class="allergy-modal-content" role="dialog" aria-modal="true" aria-labelledby="allergy-title">
        <h2 id="allergy-title">Allergiekarte</h2>
        <div class="allergy-tabs">
          <button class="lang-btn active" data-lang="hr" aria-label="Kroatisch">HR</button>
          <button class="lang-btn" data-lang="de" aria-label="Deutsch">DE</button>
          <button class="lang-btn" data-lang="en" aria-label="Englisch">EN</button>
        </div>
        <div class="allergy-text" data-lang="hr">
          Imam ozbiljnu alergiju na orašaste plodove i životno opasno reagiram na orašaste i koštuničave plodove. Molim vas pripazite.
        </div>
        <div class="allergy-text" data-lang="de" hidden>
          Ich habe eine schwere Nussallergie und reagiere lebensgefährlich auf Nüsse und Schalenfrüchte. Bitte achten Sie darauf.
        </div>
        <div class="allergy-text" data-lang="en" hidden>
          I have a severe nut allergy and I react life‑threateningly to nuts and tree nuts. Please take care.
        </div>
        <button type="button" class="allergy-close" aria-label="Schließen">Schließen</button>
      </div>
    </div>
    <!-- Day 1 -->
    <section id="day1">
      <h2>Tag 1 – Samstag | Ankommen &amp; Soft Launch (Split)</h2>
      <div class="day-content">
        <ul>
          <li><strong>Vormittag:</strong> Brunch im <a href="https://www.google.com/maps/search/?api=1&query=Fig+Split,Split,Croatia" target="_blank">Fig Split</a> oder <a href="https://www.google.com/maps/search/?api=1&query=Brasserie+on+7,Split,Croatia" target="_blank">Brasserie on 7</a>, anschließend Proviant einkaufen und zur Marina Zenta fahren.</li>
          <li><strong>Nachmittag:</strong> Check‑in (ab ca. 17:00), Sicherheits‑ &amp; Boots‑Briefing, Gepäck verstauen. Der erste Abend bleibt stressfrei – Übernachtung in der Marina Zenta (kostenlos).</li>
          <li><strong>Dinner fußläufig:</strong> <a href="https://www.google.com/maps/search/?api=1&query=Dvor+Restaurant,Split,Croatia" target="_blank">Dvor</a> (gehoben, Meerblick) oder <a href="https://www.google.com/maps/search/?api=1&query=Zora+Bila,Split,Croatia" target="_blank">Zora Bila</a>.</li>
          <li><strong>Local Highlights:</strong> <a href="https://www.google.com/maps/search/?api=1&query=Konoba+Fetivi,Split,Croatia" target="_blank">Konoba Fetivi</a> (dalmatinisch), <a href="https://www.google.com/maps/search/?api=1&query=Kantun+Paulina,Split,Croatia" target="_blank">Kantun Paulina</a> (Ćevapi), <a href="https://www.google.com/maps/search/?api=1&query=Bokamorra,Split,Croatia" target="_blank">Bokamorra</a> (Pizza & Cocktails)</li>
        </ul>
        <div class="info">
          <strong>Highlights &amp; Tipps:</strong>
          • Entspannter Start: Wohlfühlfaktor für alle ab der ersten Minute – ankommen, runterkommen und genießen.  
          • Marina Zenta liegt in Split und bietet Duschen und sichere Parkplätze.  
        </div>
      </div>
    </section>
    <!-- Day 2 -->
    <section id="day2">
      <h2>Tag 2 – Sonntag | Split → Blaue Lagune → Trogir (UNESCO)</h2>
      <div class="day-content">
        <ul>
          <li><strong>07:30:</strong> Leinen los Richtung <a href="https://www.google.com/maps/search/?api=1&query=43.4401,16.1699" target="_blank">Krknjaši (Blaue Lagune)</a> auf Drvenik Veli. Vor 09:30 ansteuern, da es später sehr voll wird. Sand/Seegras, 3–6 m – auf Sandflecken zielen und den Anker gut einfahren.</li>
          <li><strong>Vormittag:</strong> Brunch vor Anker, Schwimmen &amp; Fotos im schillernden türkisen Wasser.</li>
          <li><strong>12:30:</strong> Weiterfahrt nach <a href="https://www.google.com/maps/search/?api=1&query=43.5169,16.2514" target="_blank">Trogir</a> (Marina Baotić oder Stadtquai). Altstadtspaziergang durch die UNESCO‑geschützte, venezianische Altstadt und zur Kathedrale – besonders zur Golden Hour wunderschön.</li>
          <li><strong>Abend:</strong> Dinner im <a href="https://www.google.com/maps/search/?api=1&query=Don+Dino,Trogir,Croatia" target="_blank">Don Dino</a> oder <a href="https://www.google.com/maps/search/?api=1&query=Konoba+TRS,Trogir,Croatia" target="_blank">Konoba TRS</a> (vegetarische Optionen vorhanden).</li>
          <li><strong>Local Highlights:</strong> <a href="https://www.google.com/maps/search/?api=1&query=Konoba+Fortin,Trogir,Croatia" target="_blank">Konoba Fortin</a> (Altstadt), <a href="https://www.google.com/maps/search/?api=1&query=Restaurant+Capo,Trogir,Croatia" target="_blank">Capo Trogir</a> (mediterran)</li>
        </ul>
        <div class="info">
          <strong>Allergie‑Hinweis:</strong> In Kroatien werden Nüsse selten ungefragt verwendet – dennoch immer explizit „No Nut“ oder Allergie angeben.  <br>
          <button class="allergy-btn" aria-label="Allergiekarte (HR/DE/EN)">Allergiekarte (HR/DE/EN)</button><br>
          <strong>Nautik‑Hinweis:</strong>
          Krknjaši: Der Grund ist gemischt (Sand/Seegras/Fels) – auf Sandflächen ankern, den Anker gut einfahren und Schwojen prüfen; Flachstellen zwischen den Inseln von Süden anfahren. <br>
          Blaue Lagune: Mittags vor 10:00 oder nach 15:30 ansteuern, um der Menge zu entgehen. <br>
          Trogir: UNESCO‑Hotspot – Liegeplätze und Restaurantplätze unbedingt vorab reservieren oder früh ankommen.
        </div>
      </div>
    </section>
    <!-- Day 3 -->
    <section id="day3">
      <h2>Tag 3 – Montag | Trogir → Vela Rina (optional) → Šešula‑Bucht (Šolta)</h2>
      <div class="day-content">
        <ul>
          <li><strong>Morgens:</strong> Optionaler Kurzstopp in <a href="https://www.google.com/maps/search/?api=1&query=43.3920,16.0850" target="_blank">Vela Rina</a> (Drvenik Mali) – seltene Sandbucht mit flachem, klarem Wasser – ideal zum Baden.</li>
          <li><strong>13:00–14:00:</strong> Einlaufen in die <a href="https://www.google.com/maps/search/?api=1&query=43.3934,16.2093" target="_blank">Šešula‑Bucht</a> bei Maslinica. Bojenfeld mit Restaurant‑Shuttle: Wählt das Bojen‑Restaurant <a href="https://www.google.com/maps/search/?api=1&query=Sismis+Restaurant,Maslinica,Solta,Croatia" target="_blank">Šišmiš</a> (vorab reservieren/ankern &amp; anrufen). Die Bucht ist tief eingeschnitten und bietet sehr guten Schutz.</li>
          <li><strong>Abend:</strong> Dinghy‑Pickup zum Dinner mit Meerblick, anschließend Rückfahrt unterm Sternenhimmel. Šišmiš bietet neben Fisch auch vegetarische Pastagerichte; bei Bestellung Nussallergie erwähnen.</li>
          <li><strong>Local Highlights:</strong> <a href="https://www.google.com/maps/search/?api=1&query=Sampjer,Maslinica,Solta,Croatia" target="_blank">Sampjer</a> (Hügelblick), <a href="https://www.google.com/maps/search/?api=1&query=Martinis+Marchi+Konoba,Maslinica,Solta,Croatia" target="_blank">Martinis-Marchi Konoba</a> (marina-nah)</li>
        </ul>
        <div class="info">
          <strong>Nautik‑Hinweis:</strong> Šešula ist ein tiefer Einschnitt mit sehr gutem Schutz – das Bojenfeld wird vom Restaurant Šišmiš betreut. Bis 14:00 Uhr ankommen oder vorher reservieren; bei der Einfahrt den Anker sorgfältig einfahren.  <br>
          <strong>Erlebnis:</strong> Das Bojen‑Dinner gehört zu den Highlights – ruhig Zeit für den Sonnenuntergang einplanen.
        </div>
      </div>
    </section>
    <!-- Day 4 -->
    <section id="day4">
      <h2>Tag 4 – Dienstag | Šolta → Pakleni‑Inseln (Palmižana/Vinogradišće)</h2>
      <div class="day-content">
        <ul>
          <li><strong>Mittags:</strong> Wahlweise Stopp in <a href="https://www.google.com/maps/search/?api=1&query=Smokvina+bay,Brac,Croatia" target="_blank">Smokvina</a> (S‑Brač) oder <a href="https://www.google.com/maps/search/?api=1&query=Osibova+bay,Brac,Croatia" target="_blank">Osibova</a> (SW‑Brač). Beide Buchten sind glasklar; Osibova ist offen bei Südschwell – Bojenregelungen auf Tafeln beachten.</li>
          <li><strong>Nachmittag:</strong> Weiterfahrt nach <a href="https://www.google.com/maps/search/?api=1&query=43.1606,16.3716" target="_blank">Vinogradišće</a> auf den Pakleni‑Inseln. Wählt zwischen Bojenfeld oder der ACI‑Marina Palmižana (bei West-/Südwestschwell lieber Marina). Strandbars, Beachclubs und Dinner im <a href="https://www.google.com/maps/search/?api=1&query=Zori+Timeless,Palmi%C5%BEana,Hvar,Croatia" target="_blank">Zori Timeless</a> (Fine Dining) oder <a href="https://www.google.com/maps/search/?api=1&query=Laganini,Palmi%C5%BEana,Hvar,Croatia" target="_blank">Laganini</a> genießen.</li>
          <li><strong>Abend:</strong> Wassertaxi nach Hvar‑Stadt für Sundowner auf der Festung Fortica und Cocktails in den Bars der Altstadt.</li>
          <li><strong>Local Highlights:</strong> <a href="https://www.google.com/maps/search/?api=1&query=Dalmatino,Hvar,Croatia" target="_blank">Dalmatino Hvar</a> (beliebt), <a href="https://www.google.com/maps/search/?api=1&query=Fig+Hvar,Hvar,Croatia" target="_blank">Fig Hvar</a> (Brunch)</li>
        </ul>
        <div class="info">
          <strong>Nautik‑Hinweis:</strong>
          Die Pakleni‑Bojen sind beliebt – vorab reservieren und spätestens gegen 14:00 Uhr ankommen. Bei West‑/Südschwell unbedingt die Marina Palmižana wählen. 
          Bei <a href="https://www.google.com/maps/search/?api=1&query=Osibova+bay,Brac,Croatia" target="_blank">Osibova</a> herrscht teils Bojenpflicht und offener Südschwell – Hinweise vor Ort beachten. 
          Planen Sie Mittagspausen vor 10:00 oder nach 15:30, um den Andrang zu vermeiden.
        </div>
      </div>
    </section>
    <!-- Day 5 -->
    <section id="day5">
      <h2>Tag 5 – Mittwoch | Pakleni → Stari Grad (Hvar)</h2>
      <div class="day-content">
        <ul>
          <li><strong>Vormittag:</strong> Kurzer Sprung zur <a href="https://www.google.com/maps/search/?api=1&query=Lucisca+Beach,Hvar,Croatia" target="_blank">Lučišća‑Bucht</a> (NW‑Hvar) – klein, türkis und sandig (6–10 m). Früh hin und danach weiter nach Stari Grad.</li>
          <li><strong>Nachmittag:</strong> <a href="https://www.google.com/maps/search/?api=1&query=43.1847,16.5830" target="_blank">Stari Grad</a> ansteuern (vorab reservieren). Die UNESCO‑geschützte Ebene „Ager“ mit Leihfahrrädern erkunden (flach, insta‑freundliche Felder &amp; Trockenmauern). Spaziergang durch die malerische Altstadt.</li>
          <li><strong>Abend:</strong> Dinner im <a href="https://www.google.com/maps/search/?api=1&query=Kod+Damira,Stari+Grad,Hvar,Croatia" target="_blank">Kod Damira</a> oder <a href="https://www.google.com/maps/search/?api=1&query=Nauta,Stari+Grad,Hvar,Croatia" target="_blank">Nauta</a>.</li>
          <li><strong>Local Highlights:</strong> <a href="https://www.google.com/maps/search/?api=1&query=Antika,Stari+Grad,Hvar,Croatia" target="_blank">Antika</a> (rustikal), <a href="https://www.google.com/maps/search/?api=1&query=Jurin+Podrum,Stari+Grad,Hvar,Croatia" target="_blank">Jurin Podrum</a> (Wein & Konoba)</li>
        </ul>
        <div class="info">
          <strong>Nautik‑Hinweis:</strong>
          Stari Grad besitzt Muringplätze mit Wasser und Strom – unbedingt online oder telefonisch reservieren, da der Hafen als UNESCO‑Hotspot oft ausgebucht ist. Fahrräder sind vor Ort mietbar.
        </div>
      </div>
    </section>
    <!-- Day 6 -->
    <section id="day6">
      <h2>Tag 6 – Donnerstag | Stari Grad → Lučice‑Bucht (Brač)</h2>
      <div class="day-content">
        <ul>
          <li><strong>Vormittag:</strong> Falls Osibova noch nicht besucht wurde, dort stoppen; andernfalls eine kleine Bucht an der Südküste von Brač ansteuern.</li>
          <li><strong>14:00:</strong> In die <a href="https://www.google.com/maps/search/?api=1&query=43.3240,16.4900" target="_blank">Lučice‑Bucht</a> einlaufen und Boje sichern. Die mehrarmige Traumbucht bietet hervorragenden Schutz gegen Wind aus West/Süd/Südwest. Bojen können online angefragt werden.</li>
          <li><strong>Nachmittag:</strong> Schnorcheln, Siesta und Sundowner genießen. Dinner im Restaurant „Lučice/Senko“ mit Abhol‑Service oder an Bord.</li>
          <li><strong>Local Highlights:</strong> <a href="https://www.google.com/maps/search/?api=1&query=Konoba+Dupini,Milna,Brac,Croatia" target="_blank">Konoba Dupini</a> (Milna), <a href="https://www.google.com/maps/search/?api=1&query=Pizzeria+Porto,Milna,Brac,Croatia" target="_blank">Pizzeria&Grill Porto</a> (Milna), <a href="https://www.google.com/maps/search/?api=1&query=Konoba+Kopacina,Donji+Humac,Brac,Croatia" target="_blank">Konoba Kopačina</a> (Lamm, Inselmitte)</li>
        </ul>
        <div class="info">
          <strong>Nautik‑Hinweis:</strong>
          Lučice ist mehrarmig; bei Bora (Nordost) sollte man in den inneren Arm verlegen. Für das Bojenfeld gilt: spätestens gegen 14:00 Uhr ankommen oder vorab online reservieren – der Betreiber ist das Restaurant „Lučice/Senko". 
          Wenn Sie <a href="https://www.google.com/maps/search/?api=1&query=Osibova+bay,Brac,Croatia" target="_blank">Osibova</a> als Mittagsstopp wählen, beachten Sie die Bojenpflicht und den möglichen Südschwell.
        </div>
      </div>
    </section>
    <!-- Day 7 -->
    <section id="day7">
      <h2>Tag 7 – Freitag | Lučice → Nečujam (Šolta) → Split</h2>
      <div class="day-content">
        <ul>
          <li><strong>Morgens:</strong> Frühbad &amp; Frühstück in <a href="https://www.google.com/maps/search/?api=1&query=43.4030,16.3530" target="_blank">Nečujam</a> – die größte Bucht von Šolta mit viel Platz. Sand/Seegras, 5–10 m, guter Halt. Perfekt für einen letzten Lunch.</li>
          <li><strong>Nachmittag:</strong> Rückfahrt zur Marina Zenta (Split). Genügend Puffer für Tanken und Bootsrückgabe einplanen.</li>
          <li><strong>Abend:</strong> Abschiedsessen an der Riva in Split – z.B. im <a href="https://www.google.com/maps/search/?api=1&query=Brasserie+on+7,Split,Croatia" target="_blank">Brasserie on 7</a> oder in einer der Hafen‑Konobas.</li>
          <li><strong>Local Highlights:</strong> <a href="https://www.google.com/maps/search/?api=1&query=Konoba+Fetivi,Split,Croatia" target="_blank">Konoba Fetivi</a>, <a href="https://www.google.com/maps/search/?api=1&query=Kantun+Paulina,Split,Croatia" target="_blank">Kantun Paulina</a>, <a href="https://www.google.com/maps/search/?api=1&query=Bokamorra,Split,Croatia" target="_blank">Bokamorra</a></li>
        </ul>
        <div class="info">
          <strong>Nautik‑Hinweis:</strong>
          Nečujam bietet bei allen Winden außer Nordbora guten Schutz. Halten Sie für den letzten Schlag nach Split ausreichend Puffer zum Tanken und für die Übergabe ein.
        </div>
      </div>
    </section>
    <!-- Notes & Tips removed: integrated into daily sections -->
  </div>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
    integrity="sha256-Dxo8ibadK7nNHCdkHA8VDDH35AH58A16s/KMChgSFGQ="
    crossorigin=""
  ></script>
  <script>
    // Embedded route and places (from repo)
    /*
    const route = {
      "type": "FeatureCollection",
      "features": [
        {
          "type": "Feature",
          "properties": {"day": 2},
          "geometry": {
            "type": "LineString",
            "coordinates": [
              [16.4570, 43.4980], /* Split (Zenta) */
              [16.1699, 43.4401], /* Blaue Lagune / Krknjaši */
              [16.2514, 43.5169]  /* Trogir */
            ]
          }
        },
        {
          "type": "Feature",
          "properties": {"day": 3},
          "geometry": {
            "type": "LineString",
            "coordinates": [
              [16.2514, 43.5169], /* Trogir */
              [16.0850, 43.3920], /* Vela Rina */
              [16.2093, 43.3934]  /* Šešula */
            ]
          }
        },
        {
          "type": "Feature",
          "properties": {"day": 4},
          "geometry": {
            "type": "LineString",
            "coordinates": [
              [16.2093, 43.3934], /* Šešula */
              [16.3716, 43.1606]  /* Palmižana / Vinogradišće */
            ]
          }
        },
        {
          "type": "Feature",
          "properties": {"day": 5},
          "geometry": {
            "type": "LineString",
            "coordinates": [
              [16.3716, 43.1606], /* Palmižana */
              [16.5830, 43.1847]  /* Stari Grad */
            ]
          }
        },
        {
          "type": "Feature",
          "properties": {"day": 6},
          "geometry": {
            "type": "LineString",
            "coordinates": [
              [16.5830, 43.1847], /* Stari Grad */
              [16.4900, 43.3240]  /* Lučice */
            ]
          }
        },
        {
          "type": "Feature",
          "properties": {"day": 7},
          "geometry": {
            "type": "LineString",
            "coordinates": [
              [16.4900, 43.3240], /* Lučice */
              [16.3530, 43.4030], /* Nečujam */
              [16.4570, 43.4980]  /* Split (Zenta) */
            ]
          }
        }
      ]
    };
    const places = [
      { id: "split-zenta", name: "Split (Zenta)", coords: [43.4980, 16.4570] },
      { id: "sesula", name: "Šešula", coords: [43.3934, 16.2093] },
      { id: "blue-lagoon", name: "Blaue Lagune", coords: [43.4401, 16.1699] },
      { id: "trogir", name: "Trogir", coords: [43.5169, 16.2514] },
      // Additional markers (approximate coordinates)
      { id: "velarina", name: "Vela Rina", coords: [43.3920, 16.0850] },
      { id: "palmižana", name: "Palmižana", coords: [43.1606, 16.3716] },
      { id: "stari-grad", name: "Stari Grad", coords: [43.1847, 16.5830] },
      { id: "lucice", name: "Lučice", coords: [43.3240, 16.4900] },
      { id: "necujam", name: "Nečujam", coords: [43.4030, 16.3530] }
    ];
    // Initialize map
    const map = L.map('map').setView([43.45, 16.35], 8);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 17,
      attribution: '© OpenStreetMap contributors'
    }).addTo(map);
    // Draw route lines
    const routeLayer = L.geoJSON(route, {
      style: { color: '#0077b6', weight: 4, opacity: 0.8 }
    }).addTo(map);
    map.fitBounds(routeLayer.getBounds());
    // Add markers
    places.forEach(p => {
      const marker = L.marker([p.coords[0], p.coords[1]]).addTo(map);
      marker.bindPopup(`<strong>${p.name}</strong>`);
    });
    */
  </script>
  <!-- removed duplicate route section at bottom -->
  <script src="js/gmaps-route.js" defer></script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAz_jCzahP0Fg1Ns0i7JonTjoJlzXE59qw&callback=initMap"></script>
  <script>
    // Allergy card modal handling
    // Attach click handler to all buttons that open the allergy modal
    document.querySelectorAll('.allergy-btn').forEach(function(btn) {
      btn.addEventListener('click', function() {
        document.getElementById('allergy-modal').setAttribute('aria-hidden', 'false');
      });
    });
    document.querySelector('.allergy-close').addEventListener('click', function() {
      document.getElementById('allergy-modal').setAttribute('aria-hidden', 'true');
    });

    // Language tab switching for allergy modal
    const langBtns = document.querySelectorAll('.lang-btn');
    const allTexts = document.querySelectorAll('.allergy-text');
    langBtns.forEach(function(btn) {
      btn.addEventListener('click', function() {
        langBtns.forEach(function(b) { b.classList.remove('active'); });
        btn.classList.add('active');
        allTexts.forEach(function(txt) {
          txt.hidden = txt.dataset.lang !== btn.dataset.lang;
        });
      });
    });
  </script>
</body>
</html>

  <script>
    // --- Top spots on Google Maps ---
    (function(){
      const KINDS = ['Bucht','Hafen','Aussicht'];
      const POPS  = ['Sehr beliebt','Hotspot','Local-Liebling','Geheimtipp+'];

      function buildControls(map, ctx){
        let box = document.querySelector('.map-controls');
        if(!box){
          box = document.createElement('div');
          box.className = 'map-controls';
          box.innerHTML = `
            <h4>Top spots · Filter</h4>
            <div class="row" id="chips-kind"></div>
            <div class="row" id="chips-pop"></div>
            <div class="row" style="justify-content:space-between;margin-top:.35rem">
              <a id="windy-link" href="#" target="_blank">Windy öffnen</a>
              <a id="reset-filters" href="#">Reset</a>
            </div>
          `;
          document.body.appendChild(box);
        }
        const filters = { kind: new Set(), pop: new Set() };
        const mkChip = (label, set)=>{
          const el = document.createElement('span');
          el.className = 'chip';
          el.textContent = label;
          el.addEventListener('click', ()=>{
            if(set.has(label)) { set.delete(label); el.classList.remove('active'); }
            else { set.add(label); el.classList.add('active'); }
            applyFilter(ctx, filters);
          });
          return el;
        };
        const kindRow = box.querySelector('#chips-kind');
        const popRow  = box.querySelector('#chips-pop');
        kindRow.textContent = ''; popRow.textContent = '';
        KINDS.forEach(k=> kindRow.appendChild(mkChip(k, filters.kind)) );
        POPS.forEach(p=>  popRow.appendChild(mkChip(p, filters.pop))  );

        const windy = box.querySelector('#windy-link');
        const updateWindy = ()=>{
          const c = map.getCenter();
          const lat = c.lat().toFixed(3), lon = c.lng().toFixed(3);
          windy.href = `https://www.windy.com/${lat}/${lon}?2025082400,${lat},${lon},9`;
        };
        updateWindy();
        map.addListener('idle', updateWindy);

        box.querySelector('#reset-filters').addEventListener('click', (e)=>{
          e.preventDefault();
          filters.kind.clear(); filters.pop.clear();
          box.querySelectorAll('.chip.active').forEach(ch=> ch.classList.remove('active'));
          applyFilter(ctx, filters);
        });

        return filters;
      }

      function applyFilter(ctx, filters){
        ctx.markers.forEach(({marker, data})=>{
          const kindBase = (data.kind||'').split('·')[0].trim();
          const passKind = !filters.kind.size || filters.kind.has(kindBase);
          const passPop  = !filters.pop.size  || filters.pop.has((data.popularity||'').trim());
          marker.setVisible(!!(passKind && passPop));
        });
      }

      function popupHTML(p){
        const fmt = n=> typeof n === 'number' ? n.toFixed(6) : n;
        const lat = Number(p.coords[0]);
        const lon = Number(p.coords[1]);
        return `
          <div style="max-width:320px">
            <h3 style="margin:.25rem 0 .5rem; font-size:1.05rem;">${p.name}</h3>
            <div style="margin:.35rem 0 .2rem; font-weight:600; text-transform:uppercase; font-size:.78rem; color:#6b7280;">Instagram</div>
            <div>${p.instagram || ''}</div>
            <div style="margin:.6rem 0 .2rem; font-weight:600; text-transform:uppercase; font-size:.78rem; color:#6b7280;">Skipper Tipps</div>
            <div>${p.tips || ''}</div>
            <div style="margin-top:.5rem">
              <span style="display:inline-block;background:#eef2ff;color:#3730a3;padding:.1rem .4rem;border-radius:.375rem;font-size:.72rem;margin-right:.25rem;">${p.kind || ''}</span>
              <span style="display:inline-block;background:#ecfeff;color:#155e75;padding:.1rem .4rem;border-radius:.375rem;font-size:.72rem;margin-right:.25rem;">${p.popularity || ''}</span>
            </div>
            <div style="margin-top:.5rem;font-family:ui-monospace,Menlo,Consolas,monospace;font-size:.85rem;">Koordinaten: ${fmt(lat)}, ${fmt(lon)}</div>
          </div>`;
      }

      // Wrap initMap to hook after route map is built
      const _origInit = window.initMap;
      window.initMap = async function(){
        if(typeof _origInit === 'function') _origInit();
        try{
          const mapEl = document.getElementById('gmaps-map');
          if(!mapEl || !window._routeMap){
            // gmaps-route.js should set window._routeMap to the Google Map instance.
            // If it hasn't, try to detect the map instance from the first map on page.
          }
          // Heuristics: find the first google map instance via maps event properties
          let map = window._routeMap;
          if(!map && window.google && google.maps && google.maps.event){
            // Attempt to read from the global markers by creating a dummy map bound to the element
            // Best effort: if _routeMap wasn't exported, use the Maps API to get it via internal reference
            // As a fallback, re-initialize a read-only map on the same element – sharing center/zoom is fine
            map = new google.maps.Map(mapEl, { center: {lat:43.45, lng:16.35}, zoom: 9 });
          }
          if(!map) return;

          // Load spots
          let spots = null;
          try {
            const res = await fetch('content/map/topspots.json');
            if(res.ok) spots = await res.json();
          } catch(_) {}
          if(!spots || !Array.isArray(spots) || !spots.length){
            spots = [
              { name: 'Blue Lagoon (Krknjaši), Drvenik Veli', coords:[43.441675,16.176139], kind:'Bucht', popularity:'Sehr beliebt', instagram:'Türkis über hellem Sand, Drohnen-Shot zwischen Krknjaš Veli & Mali.', tips:'Mittagsstopp/Boje; auf Sand flecken; früh kommen.' }
            ];
          }

          const info = new google.maps.InfoWindow();
          const markers = [];
          const bounds = new google.maps.LatLngBounds();
          spots.forEach(p=>{
            const lat = Number(p.coords[0]);
            const lon = Number(p.coords[1]);
            const pos = { lat, lng: lon };
            const marker = new google.maps.Marker({ position: pos, map, title: p.name });
            marker.addListener('click', ()=>{
              info.setContent(popupHTML(p));
              info.open({ map, anchor: marker });
            });
            markers.push({ marker, data: p });
            bounds.extend(pos);
          });

          const ctx = { markers, spots };
          const filters = buildControls(map, ctx);

          // Wire nav link
          const navTop = document.getElementById('nav-top-spots');
          if(navTop){
            navTop.addEventListener('click', (e)=>{
              e.preventDefault();
              // Ensure all visible, fit bounds
              filters.kind.clear(); filters.pop.clear();
              document.querySelectorAll('.map-controls .chip.active').forEach(ch=> ch.classList.remove('active'));
              applyFilter(ctx, filters);
              map.fitBounds(bounds);
            });
          }

          // Expose for debugging
          window._topSpotsGM = ctx;
        } catch (err) {
          console.error('Top spots init failed', err);
        }
      };
    })();
  </script>
    <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sailing/sw.js', { scope: '/sailing/' });
    }
  </script>